{"ast":null,"code":"import lessonComponent from \"./components/lessonComponent.vue\";\nimport checkoutComponent from \"./components/checkoutComponent.vue\";\nexport default {\n  name: \"App\",\n  components: {\n    lessonComponent,\n    checkoutComponent\n  },\n\n  data() {\n    return {\n      lessons: [],\n      cart_items: [],\n      search_keyword: \"\",\n      sort_order: \"\",\n      attribute_sort: \"\",\n      showCheckOut: false\n    };\n  },\n\n  created() {\n    this.fetchLessons();\n  },\n\n  methods: {\n    // Toggle checkout\n    toggleCheckOut: function () {\n      if (this.showCheckOut == false) {\n        this.showCheckOut = true;\n      } else this.showCheckOut = false;\n    },\n\n    // Logic to add class activity to cart\n    addToCart(lesson) {\n      if (lesson.spaces >= 1) {\n        let lessonInCart = false;\n\n        if (this.countCart() >= 1) {\n          for (let i = 0; i < this.cart_items.length; i++) {\n            if (this.cart_items[i].id == lesson._id) {\n              this.cart_items[i].spaces += 1;\n              lessonInCart = true;\n              break;\n            }\n          }\n\n          if (lessonInCart == false) {\n            let item = {};\n            item.id = lesson._id;\n            item.spaces = 1;\n            this.cart_items.push(item);\n          }\n        } else {\n          let item = {};\n          item.id = lesson._id;\n          item.spaces = 1;\n          this.cart_items.push(item);\n        }\n\n        lesson.spaces -= 1;\n      } else {\n        lesson.spaces = 0;\n      }\n    },\n\n    // Method to count items in the cart\n    countCart() {\n      return this.cart_items.length;\n    },\n\n    // Method to return information about the items in the cart\n    cartItemsInfo() {\n      let cart_items_info = [];\n\n      for (let i = 0; i < this.cart_items.length; i++) {\n        for (let j = 0; j < this.lessons.length; j++) {\n          if (this.lessons[j]._id == this.cart_items[i].id) {\n            let item = {};\n            item.id = this.cart_items[i].id;\n            item.title = this.lessons[j].title;\n            item.location = this.lessons[j].location;\n            item.price = this.lessons[j].price;\n            item.url = this.lessons[j].url;\n            item.spaces = this.cart_items[i].spaces;\n            cart_items_info.push(item);\n          }\n        }\n      }\n\n      return cart_items_info;\n    },\n\n    // Logic to disable add to cart button if number of spaces reaches zero\n    // Logic to disable art button if no items in the cart\n    hideCart() {\n      if (this.countCart() >= 1) {\n        return false;\n      }\n\n      return true;\n    },\n\n    // Remove items from cart\n    removeFromCart(obj) {\n      for (let i = 0; i < this.lessons.length; i++) {\n        if (this.lessons[i]._id == obj.id) {\n          this.lessons[i].spaces += obj.spaces;\n        }\n      }\n\n      for (let i = 0; i < this.cart_items.length; i++) {\n        if (this.cart_items[i].id == obj.id) {\n          this.cart_items.splice(i, 1);\n        }\n      }\n    },\n\n    // Checkout logic\n    checkOut(order_details) {\n      let order = {\n        name: order_details.firstname + \" \" + order_details.lastname,\n        phone_number: order_details.mobile,\n        items: this.cart_items\n      };\n      let order_string = JSON.stringify(order);\n      fetch(\"https://coursework-two-king.herokuapp.com/collection/orders\", {\n        method: \"POST\",\n        body: order_string,\n        headers: {\n          \"Content-type\": \"application/json; charset=UTF-8\"\n        }\n      }).then(response => response.json()).then(json_response => {\n        console.log(json_response);\n        this.updateSpaces();\n      }).catch(err => console.log(err));\n    },\n\n    // Update spaces in db\n    updateSpaces() {\n      let spaces_upd = [];\n\n      for (let i = 0; i < this.cart_items.length; i++) {\n        for (let j = 0; j < this.lessons.length; j++) {\n          if (this.cart_items[i].id == this.lessons[j]._id) {\n            let item = {\n              id: this.cart_items[i].id,\n              spaces: this.lessons[j].spaces\n            };\n            spaces_upd.push(item);\n          }\n        }\n      }\n\n      let spaces_upd_string = JSON.stringify(spaces_upd);\n      fetch(\"https://coursework-two-king.herokuapp.com/collection/activities\", {\n        method: \"PUT\",\n        body: spaces_upd_string,\n        headers: {\n          \"Content-type\": \"application/json; charset=UTF-8\"\n        }\n      }).then(response => response.json()).then(response => {\n        console.log(response);\n        this.cart_items = [];\n        alert(\"Order submitted successfully!\");\n        this.showCheckOut = false;\n      }).catch(err => console.log(err));\n    },\n\n    // Logic to fetch lists from server\n    fetchLessons() {\n      fetch(`https://coursework-two-king.herokuapp.com/collection/activities`).then(res => {\n        return res.json();\n      }).then(data => {\n        this.lessons = data;\n        console.log(this.lessons);\n      }).catch(err => {\n        this.lessons = [];\n        console.log(`unable to get lessons: ${err}`);\n      });\n    },\n\n    // Logic to call back end express filter logic\n    filterLessons() {\n      fetch(`https://coursework-two-king.herokuapp.com/collection/activities/search?filter=${this.search_keyword}`).then(res => {\n        return res.json();\n      }).then(data => {\n        this.lessons = data;\n      }).catch(err => {\n        this.lessons = [];\n        console.log(`unable to get lessons: ${err}`);\n      });\n    },\n\n    //Logic to filter results based on search keyword\n    sortList() {\n      /** >>>>>>>>>>>>>> SORT BASED ON PROPERTY <<<<<<<<<<<<<<<<<< **/\n      if (this.attribute_sort == \"location\") {\n        this.lessons.sort(this.sortbyLocation);\n      } else if (this.attribute_sort == \"price\") {\n        this.lessons.sort(this.sortbyPrice);\n      } else if (this.attribute_sort == \"spaces\") {\n        this.lessons.sort(this.sortbySpaces);\n      } else {\n        this.lessons.sort(this.sortbyTitle);\n      }\n      /** >>>>>>>> SPECITY ORDER (ascending or descending) <<<<<<<< **/\n\n\n      if (this.sort_order == \"descending\") {\n        this.lessons.reverse();\n      }\n    },\n\n    /** Functions to sort based on various poperties **/\n    // | >>>>>>>>>>> Sort by title/subject <<<<<<<<<<< |\n    sortbyTitle(a, b) {\n      if (a.title.toLowerCase() < b.title.toLowerCase()) {\n        return -1;\n      }\n\n      if (a.title.toLowerCase() > b.title.toLowerCase()) {\n        return 1;\n      }\n\n      return 0;\n    },\n\n    // | >>>>>>>>>>> Sort by Location <<<<<<<<<<< |\n    sortbyLocation(a, b) {\n      if (a.location.toLowerCase() < b.location.toLowerCase()) {\n        return -1;\n      }\n\n      if (a.location.toLowerCase() > b.location.toLowerCase()) {\n        return 1;\n      }\n\n      return 0;\n    },\n\n    // | >>>>>>>>>>> Sort by price <<<<<<<<<<< |\n    sortbyPrice(a, b) {\n      return a.price - b.price;\n    },\n\n    // | >>>>>>>>>>> Sort by spaces <<<<<<<<<<< |\n    sortbySpaces(a, b) {\n      return a.spaces - b.spaces;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA4HA;AACA;AACA;EACAA,WADA;EAEAC;IACAC,eADA;IAEAC;EAFA,CAFA;;EAMAC;IACA;MACAC,WADA;MAEAC,cAFA;MAGAC,kBAHA;MAIAC,cAJA;MAKAC,kBALA;MAMAC;IANA;EAQA,CAfA;;EAgBAC;IACA;EACA,CAlBA;;EAmBAC;IACA;IACAC;MACA;QACA;MACA,CAFA,MAEA;IACA,CANA;;IAQA;IACAC;MACA;QACA;;QACA;UACA;YACA;cACA;cACAC;cACA;YACA;UACA;;UACA;YACA;YACAC;YACAA;YACA;UACA;QACA,CAdA,MAcA;UACA;UACAA;UACAA;UACA;QACA;;QACAC;MACA,CAvBA,MAuBA;QACAA;MACA;IACA,CApCA;;IAsCA;IACAC;MACA;IACA,CAzCA;;IA2CA;IACAC;MACA;;MACA;QACA;UACA;YACA;YACAH;YACAA;YACAA;YACAA;YACAA;YACAA;YACAI;UACA;QACA;MACA;;MACA;IACA,CA7DA;;IA+DA;IAEA;IACAC;MACA;QACA;MACA;;MACA;IACA,CAvEA;;IAyEA;IACAC;MACA;QACA;UACA;QACA;MACA;;MACA;QACA;UACA;QACA;MACA;IACA,CArFA;;IAuFA;IACAC;MACA;QACAvB,4DADA;QAEAwB,kCAFA;QAGAC;MAHA;MAKA;MACAC;QACAC,cADA;QAEAC,kBAFA;QAGAC;UACA;QADA;MAHA,GAOAC,IAPA,CAOAC,2BAPA,EAQAD,IARA,CAQAE;QACAC;QACA;MACA,CAXA,EAYAC,KAZA,CAYAC,uBAZA;IAaA,CA5GA;;IA8GA;IACAC;MACA;;MACA;QACA;UACA;YACA;cACAC,yBADA;cAEAC;YAFA;YAIAC;UACA;QACA;MACA;;MACA;MACAb;QACAC,aADA;QAEAC,uBAFA;QAGAC;UACA;QADA;MAHA,GAOAC,IAPA,CAOAC,2BAPA,EAQAD,IARA,CAQAC;QACAE;QACA;QACAO;QACA;MACA,CAbA,EAcAN,KAdA,CAcAC,uBAdA;IAeA,CA5IA;;IA8IA;IACAM;MACAf,yEACAI,IADA,CACAY;QACA;MACA,CAHA,EAIAZ,IAJA,CAIA1B;QACA;QACA6B;MACA,CAPA,EAQAC,KARA,CAQAC;QACA;QACAF;MACA,CAXA;IAYA,CA5JA;;IA8JA;IACAU;MACAjB,MACA,sGADA,EAGAI,IAHA,CAGAY;QACA;MACA,CALA,EAMAZ,IANA,CAMA1B;QACA;MACA,CARA,EASA8B,KATA,CASAC;QACA;QACAF;MACA,CAZA;IAaA,CA7KA;;IA+KA;IACAW;MACA;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA,CAFA,MAEA;QACA;MACA,CAFA,MAEA;QACA;MACA;MAEA;;;MACA;QACA;MACA;IACA,CAhMA;;IAkMA;IAEA;IACAC;MACA;QACA;MACA;;MACA;QACA;MACA;;MACA;IACA,CA7MA;;IA+MA;IACAC;MACA;QACA;MACA;;MACA;QACA;MACA;;MACA;IACA,CAxNA;;IA0NA;IACAC;MACA;IACA,CA7NA;;IA+NA;IACAC;MACA;IACA;;EAlOA;AAnBA","names":["name","components","lessonComponent","checkoutComponent","data","lessons","cart_items","search_keyword","sort_order","attribute_sort","showCheckOut","created","methods","toggleCheckOut","addToCart","lessonInCart","item","lesson","countCart","cartItemsInfo","cart_items_info","hideCart","removeFromCart","checkOut","phone_number","items","fetch","method","body","headers","then","response","json_response","console","catch","err","updateSpaces","id","spaces","spaces_upd","alert","fetchLessons","res","filterLessons","sortList","sortbyTitle","sortbyLocation","sortbyPrice","sortbySpaces"],"sourceRoot":"src","sources":["App.vue"],"sourcesContent":["<template>\n  <div id=\"app\">\n    <nav class=\"navbar navbar-light bg-white border-bottom navbar-expand\">\n      <div class=\"container-fluid\">\n        <a class=\"navbar-brand fw-bold\" href=\"#\">After-school Lessons 📚</a>\n        <button\n          class=\"navbar-toggler\"\n          type=\"button\"\n          data-bs-toggle=\"collapse\"\n          data-bs-target=\"#navbarNav\"\n          aria-controls=\"navbarNav\"\n          aria-expanded=\"false\"\n          aria-label=\"Toggle navigation\"\n        >\n          <span class=\"navbar-toggler-icon\"></span>\n        </button>\n        <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\n          <ul class=\"navbar-nav ms-auto\">\n            <li class=\"nav-item\">\n              <button\n                v-bind:disabled=\"hideCart()\"\n                v-on:click=\"toggleCheckOut\"\n                type=\"button\"\n                class=\"btn rounded-10 btn-md btn-warning position-relative\"\n              >\n                <i class=\"fas fa-cart-arrow-down\"></i>\n                <span\n                  class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-dark\"\n                >\n                  {{ countCart() }}\n                </span>\n              </button>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </nav>\n    <!-- Page-caption and filters-->\n    <div class=\"container-fluid border-bottom mt-3\">\n      <div class=\"row justify-content-center\">\n        <div class=\"col-md-7\">\n          <h1 class=\"text-center page-caption\">\n            Search after school activities and lessons for your wards and kids\n            👨‍🎓\n          </h1>\n          <p class=\"text-center\">\n            Quality knowledge and skills to empower the new generation!\n          </p>\n        </div>\n      </div>\n      <div class=\"container\">\n        <div class=\"row mb-3 mt-2 justify-content-center\">\n          <div class=\"col-md-12\">\n            <div class=\"row justify-content-center\">\n              <div class=\"col-sm-5 mb-2\">\n                <input\n                  v-on:input=\"filterLessons\"\n                  v-model=\"search_keyword\"\n                  type=\"text\"\n                  class=\"form-control rounded-0 p-2\"\n                  placeholder=\"Search names, locations for interesting activities...\"\n                  aria-label=\"Recipient's username\"\n                  aria-describedby=\"button-addon2\"\n                />\n              </div>\n              <div class=\"col-sm-4 mb-2\">\n                <select\n                  v-on:change=\"sortList\"\n                  v-model=\"attribute_sort\"\n                  class=\"form-select p-2 rounded-0\"\n                >\n                  <option value=\"\">-- Sort options --</option>\n                  <option value=\"title\">Subject</option>\n                  <option value=\"location\">Location</option>\n                  <option value=\"price\">Price</option>\n                  <option value=\"spaces\">Availability</option>\n                </select>\n              </div>\n              <div class=\"col-sm-3 mb-2\">\n                <select\n                  v-on:change=\"sortList\"\n                  v-model=\"sort_order\"\n                  class=\"form-select p-2 rounded-0\"\n                >\n                  <option value=\"\">-- Sort order --</option>\n                  <option value=\"ascending\">Ascending</option>\n                  <option value=\"descending\">Descending</option>\n                </select>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"container mt-3\">\n      <checkout-component\n        v-if=\"showCheckOut\"\n        :cartItems=\"cartItemsInfo()\"\n        v-on:remove-lesson=\"removeFromCart($event)\"\n        v-on:checkout=\"checkOut($event)\"\n      ></checkout-component>\n      <div v-else class=\"row\">\n        <div class=\"col-sm-3 mb-2\" v-for=\"lesson in lessons\" :key=\"lesson.id\">\n          <lesson-component\n            :lesson=\"lesson\"\n            v-on:add-to-cart=\"addToCart($event)\"\n          ></lesson-component>\n        </div>\n      </div>\n    </div>\n\n    <footer>\n      <div class=\"container mt-5\">\n        <div class=\"rown justify-content-center\">\n          <p class=\"text-center m-0\">Made with ❤️ and Vue js</p>\n          <p class=\"text-center m-0\">🦸SchoolHero | &copy; 2022</p>\n        </div>\n      </div>\n    </footer>\n  </div>\n</template>\n\n<script>\nimport lessonComponent from \"./components/lessonComponent.vue\";\nimport checkoutComponent from \"./components/checkoutComponent.vue\";\nexport default {\n  name: \"App\",\n  components: {\n    lessonComponent,\n    checkoutComponent,\n  },\n  data() {\n    return {\n      lessons: [],\n      cart_items: [],\n      search_keyword: \"\",\n      sort_order: \"\",\n      attribute_sort: \"\",\n      showCheckOut: false,\n    };\n  },\n  created() {\n    this.fetchLessons();\n  },\n  methods: {\n    // Toggle checkout\n    toggleCheckOut: function () {\n      if (this.showCheckOut == false) {\n        this.showCheckOut = true;\n      } else this.showCheckOut = false;\n    },\n\n    // Logic to add class activity to cart\n    addToCart(lesson) {\n      if (lesson.spaces >= 1) {\n        let lessonInCart = false;\n        if (this.countCart() >= 1) {\n          for (let i = 0; i < this.cart_items.length; i++) {\n            if (this.cart_items[i].id == lesson._id) {\n              this.cart_items[i].spaces += 1;\n              lessonInCart = true;\n              break;\n            }\n          }\n          if (lessonInCart == false) {\n            let item = {};\n            item.id = lesson._id;\n            item.spaces = 1;\n            this.cart_items.push(item);\n          }\n        } else {\n          let item = {};\n          item.id = lesson._id;\n          item.spaces = 1;\n          this.cart_items.push(item);\n        }\n        lesson.spaces -= 1;\n      } else {\n        lesson.spaces = 0;\n      }\n    },\n\n    // Method to count items in the cart\n    countCart() {\n      return this.cart_items.length;\n    },\n\n    // Method to return information about the items in the cart\n    cartItemsInfo() {\n      let cart_items_info = [];\n      for (let i = 0; i < this.cart_items.length; i++) {\n        for (let j = 0; j < this.lessons.length; j++) {\n          if (this.lessons[j]._id == this.cart_items[i].id) {\n            let item = {};\n            item.id = this.cart_items[i].id;\n            item.title = this.lessons[j].title;\n            item.location = this.lessons[j].location;\n            item.price = this.lessons[j].price;\n            item.url = this.lessons[j].url;\n            item.spaces = this.cart_items[i].spaces;\n            cart_items_info.push(item);\n          }\n        }\n      }\n      return cart_items_info;\n    },\n\n    // Logic to disable add to cart button if number of spaces reaches zero\n\n    // Logic to disable art button if no items in the cart\n    hideCart() {\n      if (this.countCart() >= 1) {\n        return false;\n      }\n      return true;\n    },\n\n    // Remove items from cart\n    removeFromCart(obj) {\n      for (let i = 0; i < this.lessons.length; i++) {\n        if (this.lessons[i]._id == obj.id) {\n          this.lessons[i].spaces += obj.spaces;\n        }\n      }\n      for (let i = 0; i < this.cart_items.length; i++) {\n        if (this.cart_items[i].id == obj.id) {\n          this.cart_items.splice(i, 1);\n        }\n      }\n    },\n\n    // Checkout logic\n    checkOut(order_details) {\n      let order = {\n        name: order_details.firstname + \" \" + order_details.lastname,\n        phone_number: order_details.mobile,\n        items: this.cart_items,\n      };\n      let order_string = JSON.stringify(order);\n      fetch(\"https://coursework-two-king.herokuapp.com/collection/orders\", {\n        method: \"POST\",\n        body: order_string,\n        headers: {\n          \"Content-type\": \"application/json; charset=UTF-8\",\n        },\n      })\n        .then((response) => response.json())\n        .then((json_response) => {\n          console.log(json_response);\n          this.updateSpaces();\n        })\n        .catch((err) => console.log(err));\n    },\n\n    // Update spaces in db\n    updateSpaces() {\n      let spaces_upd = [];\n      for (let i = 0; i < this.cart_items.length; i++) {\n        for (let j = 0; j < this.lessons.length; j++) {\n          if (this.cart_items[i].id == this.lessons[j]._id) {\n            let item = {\n              id: this.cart_items[i].id,\n              spaces: this.lessons[j].spaces,\n            };\n            spaces_upd.push(item);\n          }\n        }\n      }\n      let spaces_upd_string = JSON.stringify(spaces_upd);\n      fetch(\"https://coursework-two-king.herokuapp.com/collection/activities\", {\n        method: \"PUT\",\n        body: spaces_upd_string,\n        headers: {\n          \"Content-type\": \"application/json; charset=UTF-8\",\n        },\n      })\n        .then((response) => response.json())\n        .then((response) => {\n          console.log(response);\n          this.cart_items = [];\n          alert(\"Order submitted successfully!\");\n          this.showCheckOut = false;\n        })\n        .catch((err) => console.log(err));\n    },\n\n    // Logic to fetch lists from server\n    fetchLessons() {\n      fetch(`https://coursework-two-king.herokuapp.com/collection/activities`)\n        .then((res) => {\n          return res.json();\n        })\n        .then((data) => {\n          this.lessons = data;\n          console.log(this.lessons);\n        })\n        .catch((err) => {\n          this.lessons = [];\n          console.log(`unable to get lessons: ${err}`);\n        });\n    },\n\n    // Logic to call back end express filter logic\n    filterLessons() {\n      fetch(\n        `https://coursework-two-king.herokuapp.com/collection/activities/search?filter=${this.search_keyword}`\n      )\n        .then((res) => {\n          return res.json();\n        })\n        .then((data) => {\n          this.lessons = data;\n        })\n        .catch((err) => {\n          this.lessons = [];\n          console.log(`unable to get lessons: ${err}`);\n        });\n    },\n\n    //Logic to filter results based on search keyword\n    sortList() {\n      /** >>>>>>>>>>>>>> SORT BASED ON PROPERTY <<<<<<<<<<<<<<<<<< **/\n      if (this.attribute_sort == \"location\") {\n        this.lessons.sort(this.sortbyLocation);\n      } else if (this.attribute_sort == \"price\") {\n        this.lessons.sort(this.sortbyPrice);\n      } else if (this.attribute_sort == \"spaces\") {\n        this.lessons.sort(this.sortbySpaces);\n      } else {\n        this.lessons.sort(this.sortbyTitle);\n      }\n\n      /** >>>>>>>> SPECITY ORDER (ascending or descending) <<<<<<<< **/\n      if (this.sort_order == \"descending\") {\n        this.lessons.reverse();\n      }\n    },\n\n    /** Functions to sort based on various poperties **/\n\n    // | >>>>>>>>>>> Sort by title/subject <<<<<<<<<<< |\n    sortbyTitle(a, b) {\n      if (a.title.toLowerCase() < b.title.toLowerCase()) {\n        return -1;\n      }\n      if (a.title.toLowerCase() > b.title.toLowerCase()) {\n        return 1;\n      }\n      return 0;\n    },\n\n    // | >>>>>>>>>>> Sort by Location <<<<<<<<<<< |\n    sortbyLocation(a, b) {\n      if (a.location.toLowerCase() < b.location.toLowerCase()) {\n        return -1;\n      }\n      if (a.location.toLowerCase() > b.location.toLowerCase()) {\n        return 1;\n      }\n      return 0;\n    },\n\n    // | >>>>>>>>>>> Sort by price <<<<<<<<<<< |\n    sortbyPrice(a, b) {\n      return a.price - b.price;\n    },\n\n    // | >>>>>>>>>>> Sort by spaces <<<<<<<<<<< |\n    sortbySpaces(a, b) {\n      return a.spaces - b.spaces;\n    },\n  },\n};\n</script>\n"]},"metadata":{},"sourceType":"module"}